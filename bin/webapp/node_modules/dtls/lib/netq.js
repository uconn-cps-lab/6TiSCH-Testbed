var dtls_config      = require('dtls/dtls_config.js');
var memset           = require('dtls/dtls_config').memset;
var memcpy           = require('dtls/dtls_config').memcpy;
var dtls_info        = require('dtls/dtls_config').dtls_info;
var dtls_warn        = require('dtls/dtls_config').dtls_warn;

function netq_node_find(node) 
{
   var found = -1;
   if (node && node.session && node.session.sendqueue)
   {
      var queue = node.session.sendqueue;
      for (var i = 0; i < queue.length; i++)
      {
         if (queue[i] == node)
         {
            found = i;
            break;
         }
      }
   }
   
   return found;
}

module.exports.netq_insert_node = function(node) 
{
   if (node && node.session && node.session.sendqueue)
   {
      var queue = node.session.sendqueue;
      var i = 0;
      
      while(i < queue.length && queue[i].t <= node.t)
      {
         i++;
      }
      
      queue.splice(i, 0, node);
   }
   return queue;
}

module.exports.netq_node_free = function(node) 
{
   var idx = netq_node_find(node);
   if (idx >= 0)
   {
      node.session.sendqueue.splice(idx, 1);
   }
}

module.exports.netq_node_find = netq_node_find;
